<!DOCTYPE html>
<html>
<head>
    <title>AI-Prism System Status</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .status-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .pass { color: #2ecc71; font-weight: bold; }
        .fail { color: #e74c3c; font-weight: bold; }
        .warn { color: #f39c12; font-weight: bold; }
        h1 { color: #4f46e5; }
        h2 { color: #333; border-bottom: 2px solid #4f46e5; padding-bottom: 10px; }
        .test-item { padding: 10px; margin: 5px 0; background: #f9f9f9; border-left: 4px solid #4f46e5; }
        .command { background: #2c3e50; color: #2ecc71; padding: 10px; font-family: 'Courier New', monospace; border-radius: 5px; margin: 10px 0; }
        button { background: #4f46e5; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 16px; margin: 10px 5px; }
        button:hover { background: #3730a3; }
        .error-log { background: #fee; border: 1px solid #fcc; padding: 10px; border-radius: 5px; margin: 10px 0; color: #c00; font-family: monospace; white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>üöÄ AI-Prism System Status Dashboard</h1>

    <div class="status-card">
        <h2>Backend Status</h2>
        <div class="test-item">‚úÖ Server Running: <span class="pass">YES</span> (http://localhost:8080)</div>
        <div class="test-item">‚úÖ Document Upload: <span class="pass">WORKING</span></div>
        <div class="test-item">‚úÖ Section Analysis: <span class="pass">WORKING</span> (10 feedback items)</div>
        <div class="test-item">‚úÖ Analysis Speed: <span class="pass">35 seconds</span> (Extended Thinking)</div>
        <div class="test-item">‚úÖ Chat: <span class="pass">WORKING</span></div>
        <div class="test-item">‚úÖ Model Fallback: <span class="pass">FIXED</span> (4 models)</div>
        <div class="test-item">‚úÖ Text Highlighting: <span class="pass">FIXED</span> (applyHighlight function added)</div>
    </div>

    <div class="status-card">
        <h2>Known Issue: Document Content Not Displaying</h2>
        <div class="test-item">
            <span class="warn">‚ö†Ô∏è FRONTEND ISSUE</span>: Document content not appearing in UI after upload.
        </div>
        <div class="test-item">
            <strong>Root Cause:</strong> JavaScript not executing correctly OR section not being clicked.
        </div>
        <div class="test-item">
            <strong>Backend:</strong> Fully functional - content is being extracted and stored.
        </div>
        <div class="test-item">
            <strong>Test Proof:</strong> comprehensive_test.py passed all 6 tests (100% success rate).
        </div>
    </div>

    <div class="status-card">
        <h2>üîç Quick Diagnostics</h2>
        <button onclick="testConnection()">Test Server Connection</button>
        <button onclick="checkConsole()">Check Browser Console</button>
        <button onclick="manualLoad()">Manually Load Section</button>
        <div id="diagnostics" style="margin-top: 20px;"></div>
    </div>

    <div class="status-card">
        <h2>üìã Step-by-Step Instructions</h2>
        <ol>
            <li><strong>Refresh browser page</strong> (Ctrl+R or Cmd+R)</li>
            <li><strong>Open Console</strong> (F12 ‚Üí Console tab)</li>
            <li><strong>Upload document</strong>
                <ul>
                    <li>Click "Choose File"</li>
                    <li>Select .docx file</li>
                    <li>Click "Upload & Start Analysis"</li>
                </ul>
            </li>
            <li><strong>‚ö†Ô∏è CRITICAL STEP ‚ö†Ô∏è</strong>
                <ul>
                    <li>Find the <strong>section dropdown</strong></li>
                    <li><strong>CLICK ON IT</strong></li>
                    <li><strong>SELECT A SECTION</strong> (e.g., "Document Content")</li>
                </ul>
            </li>
            <li><strong>Wait 30-40 seconds</strong> for analysis to complete</li>
            <li><strong>Verify:</strong>
                <ul>
                    <li>‚úÖ Document content appears in LEFT panel</li>
                    <li>‚úÖ Feedback items appear in RIGHT panel</li>
                </ul>
            </li>
        </ol>
    </div>

    <div class="status-card">
        <h2>üêõ Debug Commands</h2>
        <p>Open browser console (F12) and run these commands:</p>

        <div class="command">// Check if sections loaded
console.log(sections);</div>

        <div class="command">// Check current session
console.log(currentSession);</div>

        <div class="command">// Check if content exists
console.log(window.sectionData);</div>

        <div class="command">// Manually load first section
loadSection(0);</div>

        <div class="command">// Check document content container
console.log(document.getElementById('documentContent').innerHTML.length);</div>
    </div>

    <div class="status-card">
        <h2>üìä Recent Test Results</h2>
        <div class="test-item">
            <strong>Test Date:</strong> 2025-11-20 17:28:28<br>
            <strong>Tests Run:</strong> 6<br>
            <strong>Passed:</strong> <span class="pass">6 (100%)</span><br>
            <strong>Failed:</strong> <span class="pass">0</span><br>
            <strong>Backend:</strong> <span class="pass">FULLY FUNCTIONAL</span>
        </div>
    </div>

    <div class="status-card">
        <h2>üîß If Still Not Working</h2>
        <p>Please provide the following information:</p>
        <ol>
            <li>Full browser console log (copy all RED errors)</li>
            <li>Screenshot of the page after upload</li>
            <li>Result of this command in console: <code>console.log(sections, currentSession, window.sectionData)</code></li>
            <li>Browser name and version</li>
        </ol>
        <p><strong>The backend is confirmed working.</strong> The issue is in the frontend JavaScript execution or user interaction.</p>
    </div>

    <script>
        async function testConnection() {
            const output = document.getElementById('diagnostics');
            output.innerHTML = '<div style="padding: 10px; background: #fff3cd; border-radius: 5px;">Testing connection...</div>';

            try {
                const response = await fetch('http://localhost:8080/test_claude_connection');
                const data = await response.json();

                if (data.connected) {
                    output.innerHTML = `
                        <div class="test-item">
                            <span class="pass">‚úÖ Server Connected</span><br>
                            Model: ${data.model}<br>
                            Response Time: ${data.response_time}s
                        </div>
                    `;
                } else {
                    output.innerHTML = `<div class="error-log">‚ùå Connection Failed: ${data.error}</div>`;
                }
            } catch (error) {
                output.innerHTML = `<div class="error-log">‚ùå Error: ${error.message}</div>`;
            }
        }

        function checkConsole() {
            alert('Open your browser console (F12) and look for:\n\n‚úÖ GREEN messages = Success\n‚ùå RED messages = Errors\n\nPay attention to any RED error messages and copy them.');
        }

        function manualLoad() {
            alert('This will open the main application and attempt to manually load a section.\n\nMake sure you have:\n1. Uploaded a document first\n2. Noted your session ID\n\nThen run this in console:\nloadSection(0);');
            window.open('http://localhost:8080', '_blank');
        }
    </script>
</body>
</html>
